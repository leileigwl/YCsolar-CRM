FROM mysql:8.0

# 设置环境变量
ENV MYSQL_ROOT_PASSWORD=root
ENV MYSQL_DATABASE=crm_system
ENV MYSQL_PASSWORD=root

# 复制自定义MySQL配置
COPY config/mysql-config.cnf /etc/mysql/conf.d/

# 复制初始化SQL脚本
COPY server/db/init.sql /docker-entrypoint-initdb.d/

# 设置字符集和排序规则
RUN echo "[mysqld]" >> /etc/mysql/conf.d/charset.cnf && \
    echo "character-set-server=utf8mb4" >> /etc/mysql/conf.d/charset.cnf && \
    echo "collation-server=utf8mb4_unicode_ci" >> /etc/mysql/conf.d/charset.cnf

EXPOSE 3306

CMD ["mysqld"] 